<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Streaming Diffusion Policy: Fast Policy Synthesis with Variable Noise Diffusion Models </title>

    <meta name="description" content="Streaming Diffusion Policy">
    <meta name="viewport" content="width=device-width, initial-scale=1">


     <!--FACEBOOK-->
     <meta property="og:image" content="./img/share_image.png">
     <meta property="og:image:type" content="image/png">
     <meta property="og:image:width" content="1196">
     <meta property="og:image:height" content="705">
     <meta property="og:type" content="website" />
     <meta property="og:url" content="https://streaming-diffusion-policy.github.io/"/>
     <meta property="og:title" content="Streaming Diffusion Policy" />
     <meta property="og:description"
         content="Project page for Streaming Diffusion Policy." />
 
     <!--TWITTER-->
     <meta name="twitter:card" content="summary_large_image" />
     <meta name="twitter:title" content="Streaming Diffusion Policy" />
     <meta name="twitter:description"
         content="Project page for Streaming Diffusion Policy" />
     <meta name="twitter:image" content="./img/share_image.png" />

     

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>
	
    <style>
        .nav-pills {
          position: relative;
          display: inline;
        }
        .imtip {
          position: absolute;
          top: 0;
          left: 0;
        }
    </style>
</head>
<!-- Google tag (gtag.js) -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-5JBS73F70V"></script> -->
<!-- <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5JBS73F70V');
</script> -->
<body>
    <div class="container" id="main">
        <div class="row mt-4">
            <h2 class="col-md-12 text-center">
                <b><font size="+6">Streaming Diffusion Policy</font></b></br> 
                <br>
                <font size="+3">Fast Policy Synthesis with Variable Noise Diffusion Models</font>
            </h2>
        </div>

        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                <br>
                <li><a href="https://sigmundhh.github.io/">Sigmund H. HÃ¸eg</a></li>
                <li><a href="https://yilundu.github.io/">Yilun Du</a></li>
                <li><a href="https://www.ntnu.edu/employees/olav.egeland">Olav Egeland </a></li>
                <br>
                <br>
                </ul>
                <div class="mt-4">
                    <div class="d-inline-block mx-2 text-center">
                        <a href="#video-section" class="d-block"><i class="fas fa-video fa-2x"></i></a>
                        <span class="d-block mt-1">Video</span>
                    </div>
                    <div class="d-inline-block mx-2 text-center">
                        <a href="YOUR_CODE_LINK_HERE" class="d-block"><i class="fas fa-code fa-2x"></i></a>
                        <span class="d-block mt-1">Code</span>
                    </div>
                    <div class="d-inline-block mx-2 text-center">
                        <a href="YOUR_PAPER_LINK_HERE" class="d-block"><i class="fas fa-file-alt fa-2x"></i></a>
                        <span class="d-block mt-1">Paper</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row justify-content-md-center">
            <div class="col-md-12">
                <div class="row mt-4">
                    <div class="col-md-10 col-lg-8 mx-auto">
                        <h3 class="mt-4 mb-2">
                            Abstract
                        </h3>
                        <p class="text-justify">
                            Diffusion models have seen rapid adoption in robotic imitation learning, enabling autonomous execution of complex dexterous tasks. However, action synthesis is often slow, requiring many steps of iterative denoising, limiting the extent to which models can be used in tasks that require fast reactive policies. To sidestep this, recent works have explored how the distillation of the diffusion process can be used to accelerate policy synthesis. However, distillation is computationally expensive and can hurt both the accuracy and diversity of synthesized actions. We propose Streaming Diffusion Policy (SDP), an alternative method to accelerate policy synthesis, leveraging the insight that generating a partially denoised action trajectory is substantially faster than a full output action trajectory. At each observation, our approach outputs a partially denoised action trajectory it <i>with variable levels of noise corruption</i>, where the immediate action to execute is noise-free, with subsequent actions having increasing levels of noise and uncertainty. The partially denoised action trajectory for a new observation can then be quickly generated by applying a few steps of denoising to the previously predicted noisy action trajectory (rolled over by one timestep).  We illustrate the efficacy of this approach, dramatically speeding up policy synthesis while preserving performance across both simulated and real-world settings.
                        </p>
                    </div>
                </div>

                <div class="row mt-4 justify-content-center" id="video-container">
                    <div class="col-md-10 col-lg-8">
                        <div class="row">
                            <div class="col-md-6">
                                <video id="video1" width="100%" loop muted playsinline>
                                    <source src="videos/vis_buffer_dp_ta1.mp4" type="video/mp4">
                                </video>
                                <p class="text-center"><strong><span style="font-size: 1.2em;">Diffusion Policy</span></strong></p>
                            </div>
                            <div class="col-md-6">
                                <video id="video2" width="100%" loop muted playsinline>
                                    <source src="videos/vis_buffer_tedi-alpha1.mp4" type="video/mp4">
                                </video>
                                <p class="text-center"><strong><span style="font-size: 1.2em;">Streaming Diffusion Policy</span></strong></p>
                            </div>
                        </div>
                        <p class="text-center mt-2"><em>Hover (or tap on mobile) to play individual videos</em></p>
                    </div>
                </div>
            </div>
        </div>
        <br>
        
        <div class="row justify-content-md-center">
            <div class="col-md-10 col-lg-8 mx-auto">
                <div class="row mt-4">
                    <div class="col-md-12">
                        <p class="text-justify">
                            Our SDP approach synthesizes a persistent action buffer consisting of future actions to execute. <br>
                            We first initialize the buffer to have increasing levels of noise corruption. <br>
                            By running a few steps of denoising of this trajectory conditioned on the current observations, we have the first action clean and ready to be executed in the environment. <br>
                            After execution, we append a Gaussian noise action to the end of our buffer. This again forms a trajectory we can denoise with newly given observations.
                        </p>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-12">
                        <video id="video3" width="100%" autoplay loop muted playsinline>
                            <source src="videos/ActionBufferAnimation.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-md-10 col-lg-8 mx-auto">
                <h3 class="mt-4 mb-3">Real Push-T benchmark</h3>
                <div class="row">
                    <div class="col-md-4">
                        <div class="video-container">
                            <video id="pushVideo1" width="100%" muted playsinline>
                                <source src="videos/1_dp.mp4" type="video/mp4">
                            </video>
                        </div>
                        <p class="text-center"><strong><span style="font-size: 1.2em;">Diffusion Policy</span></strong></p>
                    </div>
                    <div class="col-md-4">
                        <div class="video-container">
                            <video id="pushVideo2" width="100%" muted playsinline>
                                <source src="videos/1_ctm.mp4" type="video/mp4">
                            </video>
                        </div>
                        <p class="text-center"><strong><span style="font-size: 1.2em;">Consistency Policy</span></strong></p>
                    </div>
                    <div class="col-md-4">
                        <div class="video-container">
                            <video id="pushVideo3" width="100%" muted playsinline>
                                <source src="videos/1_sdp.mp4" type="video/mp4">
                            </video>
                        </div>
                        <p class="text-center"><strong><span style="font-size: 1.2em;">Streaming Diffusion Policy</span></strong></p>
                    </div>
                </div>
                <div class="text-center mb-3">
                    <button id="playAllBtn" class="btn btn-primary">Play All Videos</button>
                </div>
            </div>
        </div>
        
        <div class="row mt-4" id="video-section">
            <div class="col-md-10 col-lg-8 mx-auto">
                <h3 class="mt-4 mb-2">Video</h3>
                <div class="ratio ratio-16x9">
                    <iframe src="https://www.youtube.com/embed/58VLJEDQCg0" title="YouTube video" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    <div class="row mt-5">
        <div class="col-md-12">
            <hr>
            <footer class="text-center pb-5">
                <p></p>
            </footer>
        </div>
    </div>
        
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>hljs.highlightAll();</script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    const video1 = document.getElementById('video1');
    const video2 = document.getElementById('video2');
    const video3 = document.getElementById('video3');
    const pushVideo1 = document.getElementById('pushVideo1');
    const pushVideo2 = document.getElementById('pushVideo2');
    const pushVideo3 = document.getElementById('pushVideo3');
    
    function handleVideoEnd(video) {
        video.currentTime = 0;
        video.pause();
    }

    [video1, video2, video3, pushVideo1, pushVideo2, pushVideo3].forEach(video => {
        video.addEventListener('ended', () => handleVideoEnd(video));
    });

    // Function to handle video play/pause
    function toggleVideo(video) {
        if (video.paused) {
            video.play();
        } else {
            video.pause();
        }
    }
    
    // Add event listeners for both hover and touch
    [video1, video2].forEach(video => {
        // Hover events for desktop
        video.addEventListener('mouseenter', () => toggleVideo(video));
        video.addEventListener('mouseleave', () => toggleVideo(video));
        
        // Touch events for mobile
        video.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevent default touch behavior
            toggleVideo(video);
        });
    });

    // Real Push-t benchmark video control
    const playAllBtn = document.getElementById('playAllBtn');
    const pushVideos = [pushVideo1, pushVideo2, pushVideo3];

    playAllBtn.addEventListener('click', () => {
        pushVideos.forEach(video => {
            video.currentTime = 0; // Reset to beginning
            video.play();
        });
    });
});
</script>
</body>
</html>
